# Changelog

<!--
Added: For new features.

Changed: For changes in existing functionality.

Fixed: For bug fixes.

Removed: For deprecated or removed features.
 -->


## v0.6-week-6 (06-12-2025)

### Added
- `Store::create_name_search_index()` to index contacts by name.
- `Store::create_email_domain_search_index()` to index contacts by email domain.
- Both `create_name_search_index` and `create_email_domain_search_index` spawns multiply concurrent threads with maximum of 5 threads depending on the data size, to search through respective chunks of the contact list to create an in-memory index of contacts for faster search.
These concurrent threads significantly reduces the indexing time.
- `Store::fuzzy_search_name()` performs fuzzy search by concurrently searching through chunks of the contact list using multiple threads (max 5 depending on data size) and return the result of 10 best matches based on Levenshtein distance using the `rust-fuzzy-search` crate. These functions return a top 10 list of contact where the **Levenshtein distance** between the search string and search result **is >= 4.**
- `Store::fuzzy_search_email_domain_index()` creates the contact index and performs a fuzzy search (by email domain). These functions return a list of contacts that has the same email domain as the search string.
- Search command in `cli/commands.rs`.
- Handle search command in `cli/run.rs`.
- PoisonError to AppError for unified Error handling.
- `Index` struct in filestore.rs to store in-memory index of contacts both by name and email domain.



### Changes
- `Store::mem` field now uses a Hashmap datastructure to store contacts to enable quick and lookup and stable indexing via unique Uuids.
- Contact struct now has `Contact.id` field to store contact unique id as `Uuid`. The id field is automatically generated by the constructor - `Contact::new()`.
- Contact struct now has two `DateTime<Utc>` field (`created_at` and `updated_at`).
- Abstract storage into a single `filestore::Store` that can switch and migrate between storage format but using the same struct and method, to reduce duplicate code.
- Refactored `fuzzy_search_name()`, `fuzzy_search_email_domain_index()`, `create_name_search_index` and `search::create_email_domain_search_index()` from search.rs, to all be implementations of the `Store` struct for easier and quicker access reducing loading overhead.
- `search` module no longer exist.
- Integrated `Index` into methods and functionalities that requires searching to optimize speed, e.g. `get_indices_by_name()`, search command logic ect.

### Fixed
- Duplicated contact during migration through the implementation of `PartialEq` for Contact struct.
- Adjusted the txt Serializer and Deserializer function in `helper.rs` to accomodate new timestamp feilds with backward compatibility.
- Adjusted the rest of codbase to use `Contact::new()` where necessary.
- Created `deserialize_timestamp()` and `default_timestamp()` functions in contact.js used by serde to set default and deserialize old contacts with `created_at` fields initially set to `None`.
- Improved filtered listing performance by filtering directly from the in-memory HashMap instead of deserializing all contacts from disk first before filtering.